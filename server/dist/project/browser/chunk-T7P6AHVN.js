import{a as ve}from"./chunk-OWWKG2UH.js";import{b as ue}from"./chunk-JCXD3SEF.js";import{n as ge}from"./chunk-IDOUBITA.js";import{a as fe}from"./chunk-L5IHBF74.js";import{b as we,d as xe}from"./chunk-LBUVAIDA.js";import{b as me}from"./chunk-NEF4TMLT.js";import{$ as Z,U as q,b as le,c as de,kb as ce,sb as he,wb as pe}from"./chunk-G6XNEXZK.js";import{Aa as V,Cb as y,Hb as L,Mb as S,Nb as oe,Pb as se,Qb as ae,Rb as g,Sb as p,Tb as w,Xb as A,_b as T,ab as te,ac as M,da as k,ea as z,fb as v,g as O,gb as G,ia as ee,ja as F,kc as b,lb as ie,na as P,oa as E,ob as ne,od as H,rc as Q,sc as W,ub as re,xa as $,ya as B,za as D}from"./chunk-ELVZKH6B.js";import{a as _,b as C,g as K,h as Y,i as N,j as U}from"./chunk-PXA7OGPQ.js";var ye=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=E({type:e}),e.\u0275inj=z({imports:[Z,q,Z,q]});let t=e;return t})();var f=function(t){return t[t.Up=1]="Up",t[t.Down=3]="Down",t[t.Right=6]="Right",t[t.Left=8]="Left",t[t.UpMirrored=2]="UpMirrored",t[t.DownMirrored=4]="DownMirrored",t[t.LeftMirrored=5]="LeftMirrored",t[t.RightMirrored=7]="RightMirrored",t[t.Default=0]="Default",t[t.NotJpeg=-1]="NotJpeg",t[t.NotDefined=-2]="NotDefined",t}(f||{}),X=class{constructor(){this.byteCount=e=>encodeURI(e).split(/%..|./).length-1}getOrientation(e){return new Promise((s,n)=>{try{let i=new FileReader;i.onload=()=>{let o=new DataView(i.result);if(!o.byteLength||o.getUint16(0,!1)!==65496)return s(f.NotDefined);let a=o.byteLength,r=2;for(;r<a;){let l=o.getUint16(r,!1);if(r+=2,l===65505){if(o.getUint32(r+=2,!1)!==1165519206)return s(f.NotJpeg);let m=o.getUint16(r+=6,!1)===18761;r+=o.getUint32(r+4,m);let h=o.getUint16(r,m);r+=2;for(let d=0;d<h;d++)if(o.getUint16(r+d*12,m)===274)return s(o.getUint16(r+d*12+8,m))}else{if((l&65280)!==65280)break;r+=o.getUint16(r,!1)}}return s(f.NotJpeg)},i.readAsArrayBuffer(e)}catch{return n(f.Default)}})}uploadFile(e,s=!0,n=!1){return new Promise((i,o)=>{let a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=/iPad|iPhone|iPod/i.test(navigator.userAgent);Promise.resolve(a||r).then(l=>l?this.generateUploadInputNative(window.document,s,n):this.generateUploadInputRenderer(e,s,n)).then(l=>{let m=l?Array.from(l):[],h=m.map(u=>this.getOrientation(u)),d=m.map(u=>this.fileToDataURL(u)),c=[];Promise.all(h).then(u=>(c=u,Promise.all(d))).then(u=>{let x=u.map((I,j)=>({image:I.dataUrl,orientation:c[j],fileName:I.fileName}));i(s?x:x[0])})}).catch(l=>o(l))})}fileToDataURL(e){return new Promise((s,n)=>{let i=new FileReader;i.onload=o=>{s({dataUrl:o.target.result,fileName:e.name})};try{i.readAsDataURL(e)}catch(o){n(`ngx-image-compress - probably no file have been selected: ${o}`)}})}generateUploadInputRenderer(e,s=!0,n=!1){let i=!1;return new Promise((o,a)=>{let r=e.createElement("input");e.setStyle(r,"display","none"),e.setProperty(r,"type","file"),e.setProperty(r,"accept","image/*, .heic"),s&&e.setProperty(r,"multiple","true"),e.listen(r,"click",l=>{l.target.value=""}),e.listen(r,"change",l=>{i=!0;let m=l.target.files;o(m)}),n&&window.addEventListener("focus",()=>{setTimeout(()=>{i||a(new Error("file upload on blur - no file selected"))},300)},{once:!0}),r.click()})}generateUploadInputNative(e,s=!0,n=!1){let i=!1;return new Promise((o,a)=>{let r=e.createElement("input");r.id="upload-input"+new Date,r.style.display="none",r.setAttribute("type","file"),r.setAttribute("accept","image/*, .heic"),s&&r.setAttribute("multiple","true"),e.body.appendChild(r),r.addEventListener("change",()=>{i=!0,o(r.files),e.body.removeChild(e.getElementById(r.id))},{once:!0}),n&&window.addEventListener("focus",()=>{setTimeout(()=>{!i&&e.getElementById(r.id)&&(a(new Error("file upload on blur - no file selected")),e.body.removeChild(e.getElementById(r.id)))},300)},{once:!0}),r.click()})}compress(e,s,n,i=50,o=50,a=0,r=0){return new Promise(function(l,m){o=o/100,i=i/100;let h=new Image;h.onload=()=>{let d=n.createElement("canvas"),c=d.getContext("2d");if(!c)return m("No canvas context available");let u=h.naturalWidth,x=h.naturalHeight;if(!CSS.supports("image-orientation","from-image")&&(s===f.Right||s===f.Left)){let Ie=u;u=x,x=Ie}let I=a?a/u:1,j=r?r/x:1;i=Math.min(i,I,j),d.width=u*i,d.height=x*i;let R=Math.PI/180;CSS.supports("image-orientation","from-image")||s===f.Up?c.drawImage(h,0,0,d.width,d.height):s===f.Right?(c.save(),c.rotate(90*R),c.translate(0,-d.width),c.drawImage(h,0,0,d.height,d.width),c.restore()):s===f.Left?(c.save(),c.rotate(-90*R),c.translate(-d.width,0),c.drawImage(h,0,0,d.height,d.width),c.restore()):s===f.Down?(c.save(),c.rotate(180*R),c.translate(-d.width,-d.height),c.drawImage(h,0,0,d.width,d.height),c.restore()):c.drawImage(h,0,0,d.width,d.height);let Me=e.substr(5,e.split(";")[0].length-5),be=d.toDataURL(Me,o);l(be)},h.onerror=d=>m(d),h.src=e})}uploadGetImageMaxSize(e,s,n,i=!1){return U(this,null,function*(){s&&console.debug("Ngxthis - Opening upload window");let o=yield this.uploadFile(n,!1,i);return yield this.getImageMaxSize(o,e,s,n)})}getImageMaxSize(e,s,n,i){return U(this,null,function*(){let a=l=>(l/1024/1024).toFixed(2);n&&console.debug("Ngxthis - Opening upload window");let r;for(let l=0;l<10;l++){let m=this.byteCount(e.image);r=yield this.compress(e.image,e.orientation,i,50,100);let h=this.byteCount(r);if(console.debug("Ngxthis -","Compression from",a(m),"MB to",a(h),"MB"),h>=m)throw l===0?(n&&console.debug("Ngxthis -","File can't be reduced at all - returning the original",a(m),"MB large"),C(_({},e),{image:r})):(n&&console.debug("Ngxthis -","File can't be reduced more - returning the best we can, which is ",a(m),"MB large"),C(_({},e),{image:r}));if(h<s*1024*1024)return n&&console.debug("Ngxthis -","Here your file",a(h),"MB large"),C(_({},e),{image:r});if(l===9)throw n&&console.debug("Ngxthis -","File can't reach the desired size after",10,"tries. Returning file ",a(m),"MB large"),C(_({},e),{image:r});n&&console.debug("Ngxthis -","Reached",a(h),"MB large. Trying another time after",l+1,"times"),e.image=r}throw n&&console.debug("Ngxthis - Unexpected error"),{}})}},_e=(()=>{let e=class e{constructor(n){this.DOC_ORIENTATION=f,this.render=n.createRenderer(null,null),this.imageCompress=new X}byteCount(n){return this.imageCompress.byteCount(n)}getOrientation(n){return this.imageCompress.getOrientation(n)}uploadFile(){return this.imageCompress.uploadFile(this.render,!1)}uploadMultipleFiles(){return this.imageCompress.uploadFile(this.render,!0)}uploadFileOrReject(){return this.imageCompress.uploadFile(this.render,!1,!0)}uploadMultipleFilesOrReject(){return this.imageCompress.uploadFile(this.render,!0,!0)}compressFile(n,i,o=50,a=50,r=0,l=0){return this.imageCompress.compress(n,i,this.render,o,a,r,l)}uploadAndGetImageWithMaxSize(n=1,i=!1,o=!1){return this.imageCompress.uploadGetImageMaxSize(n,i,this.render,o).then(a=>a.image).catch(a=>{throw a.image})}uploadAndGetImageWithMaxSizeAndMetas(n=1,i=!1,o=!1){return this.imageCompress.uploadGetImageMaxSize(n,i,this.render,o)}getImageWithMaxSizeAndMetas(n,i=1,o=!1){return this.imageCompress.getImageMaxSize(n,i,o,this.render)}};e.\u0275fac=function(i){return new(i||e)(ee(ie))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ce=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=E({type:e}),e.\u0275inj=z({imports:[H]});let t=e;return t})();var Se=(()=>{var e;let s=class s{constructor(){Y(this,e);this.storeProfileImg=new O(null),N(this,e,F(de)),this.config=fe.apiEndPoint,this.getStoreProfileImg$=this.storeProfileImg.asObservable(),this.loading=re(!1)}get isLoading(){return this.loading.asReadonly()}setLoading(i){this.loading.set(i)}updateStoreProfileImg(i){this.storeProfileImg.next(i)}uploadImg(i){let o=i,a=new FormData;return a.append("file",o,o.name),K(this,e).post(`${this.config}admin/uploadImage`,a)}};e=new WeakMap,s.\u0275fac=function(o){return new(o||s)},s.\u0275prov=k({token:s,factory:s.\u0275fac,providedIn:"root"});let t=s;return t})();function Ee(t,e){t&1&&(g(0,"div",1),D(),g(1,"svg",12),w(2,"g",5)(3,"g",6),g(4,"g",7),w(5,"path",18),p()(),V(),g(6,"p"),b(7,"Browse File to upload!"),p()())}function De(t,e){if(t&1&&w(0,"img",19),t&2){let s=e.$implicit;L("src",s,te)}}function Le(t,e){t&1&&(g(0,"div",20),w(1,"app-loader"),p())}function Te(t,e){if(t&1&&(g(0,"span",2),se(1,De,1,1,"img",19,oe,!1,Le,2,0,"div",20),p()),t&2){let s=M();v(),ae(s.previews)}}function He(t,e){t&1&&(g(0,"p",10),b(1,"Not selected file"),p())}function je(t,e){t&1&&(g(0,"p",11),b(1,"Please click to upload"),p())}function Re(t,e){t&1&&(g(0,"span"),b(1,"Upload Image"),p())}function Ue(t,e){t&1&&(D(),g(0,"svg",22),w(1,"circle",23)(2,"path",24),p())}function $e(t,e){if(t&1){let s=A();g(0,"button",21),T("click",function(){$(s);let i=M();return B(i.uploadFiles())}),y(1,Re,2,0,"span")(2,Ue,3,0,":svg:svg",22),p()}if(t&2){let s=M();L("disabled",s.isLoading()),v(),S(s.isLoading()?2:1)}}var _t=(()=>{let e=class e{constructor(n){this.zone=n,this.service=F(Se),this.selectedFileNames=[],this.file=null,this.progressInfos=[],this.message=[],this.previews=[]}ngOnInit(){}selectFiles(n){this.message=[],this.progressInfos=[],this.selectedFileNames=[],this.selectedFiles=n.target.files;let i=n.target.files;if(this.previews=[],this.selectedFiles&&this.selectedFiles[0]){let o=this.selectedFiles.length;for(let a=0;a<o;a++){let r=new FileReader;r.onload=l=>{this.previews.push(l.target.result)},r.readAsDataURL(this.selectedFiles[a]),this.selectedFileNames.push(this.selectedFiles[a].name)}}}upload(n,i){this.progressInfos[n]={value:0,fileName:i},i&&(this.service.storeProfileImg.next(i),this.service.uploadImg(i).subscribe(o=>{o.type,le.UploadProgress}))}isLoading(){return this.service.isLoading()}uploadFiles(){if(this.service.setLoading(!0),this.message=[],this.selectedFiles)for(let n=0;n<this.selectedFiles.length;n++)this.upload(n,this.selectedFiles[n])}};e.\u0275fac=function(i){return new(i||e)(G(ne))},e.\u0275cmp=P({type:e,selectors:[["app-img-uploader"]],standalone:!0,features:[Q([_e]),W],decls:21,vars:3,consts:[[1,"container"],[1,"header"],[1,""],["for","file",1,"footer"],["fill","#000000","viewBox","0 0 32 32","xmlns","http://www.w3.org/2000/svg"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["d","M15.331 6H8.5v20h15V14.154h-8.169z"],["d","M18.153 6h-.009v5.342H23.5v-.002z"],[1,"cursor-pointer"],[1,"cursor-pointer","text-xs"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M5.16565 10.1534C5.07629 8.99181 5.99473 8 7.15975 8H16.8402C18.0053 8 18.9237 8.9918 18.8344 10.1534L18.142 19.1534C18.0619 20.1954 17.193 21 16.1479 21H7.85206C6.80699 21 5.93811 20.1954 5.85795 19.1534L5.16565 10.1534Z","stroke","#000000","stroke-width","2"],["d","M19.5 5H4.5","stroke","#000000","stroke-width","2","stroke-linecap","round"],["d","M10 3C10 2.44772 10.4477 2 11 2H13C13.5523 2 14 2.44772 14 3V5H10V3Z","stroke","#000000","stroke-width","2"],["id","file","type","file",3,"change"],["type","button",1,"text-blue","rounded","flex","items-center","justify-center",3,"disabled"],["d","M7 10V9C7 6.23858 9.23858 4 12 4C14.7614 4 17 6.23858 17 9V10C19.2091 10 21 11.7909 21 14C21 15.4806 20.1956 16.8084 19 17.5M7 10C4.79086 10 3 11.7909 3 14C3 15.4806 3.8044 16.8084 5 17.5M7 10C7.43285 10 7.84965 10.0688 8.24006 10.1959M12 12V21M12 12L15 15M12 12L9 15","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],[1,"border-2","border-dashed","border-blue","rounded-full",3,"src"],[1,"flex","items-center","justify-center"],["type","button",1,"text-blue","rounded","flex","items-center","justify-center",3,"click","disabled"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"animate-spin","h-5","w-5","text-blue"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z",1,"opacity-75"]],template:function(i,o){i&1&&(g(0,"div",0),y(1,Ee,8,0,"div",1)(2,Te,4,1,"span",2),g(3,"label",3),D(),g(4,"svg",4),w(5,"g",5)(6,"g",6),g(7,"g",7),w(8,"path",8)(9,"path",9),p()(),y(10,He,2,0,"p",10)(11,je,2,0,"p",11),g(12,"svg",12),w(13,"g",5)(14,"g",6),g(15,"g",7),w(16,"path",13)(17,"path",14)(18,"path",15),p()(),V(),g(19,"input",16),T("change",function(r){return o.selectFiles(r)}),p()(),y(20,$e,3,2,"button",17),p()),i&2&&(v(),S(o.previews.length?2:1),v(9),S(o.previews.length?11:10),v(10),S(o.previews.length?20:-1))},dependencies:[H,Ce,ce,he,ge,ye,we,ue,pe,me,xe,ve],styles:[".container[_ngcontent-%COMP%]{min-height:300px;height:fit-content;width:256px;border-radius:10px;box-shadow:4px 4px 30px #0003;display:flex;flex-direction:column;align-items:center;justify-content:space-between;padding:10px;gap:5px;background-color:#006eff0a}.header[_ngcontent-%COMP%]{flex:1;width:100%;border:2px dashed royalblue;border-radius:10px;display:flex;align-items:center;justify-content:center;flex-direction:column}.header[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:100px}.header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;color:#000}.footer[_ngcontent-%COMP%]{background-color:#006eff13;width:100%;height:40px;padding:8px;border-radius:10px;cursor:pointer;display:flex;align-items:center;justify-content:flex-end;color:#000;border:none}.footer[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:130%;fill:#4169e1;background-color:#4642421a;border-radius:50%;padding:2px;cursor:pointer;box-shadow:0 2px 30px #00000034}.footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{flex:1;text-align:center}#file[_ngcontent-%COMP%]{display:none}"]});let t=e;return t})();export{ye as a,Se as b,_t as c};
