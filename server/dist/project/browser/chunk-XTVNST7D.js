import{a as Te}from"./chunk-GQXIZLIE.js";import{a as be}from"./chunk-2BJEWKFC.js";import{d as Q,e as ee,f as te,h as ie,n as ge,o as fe,p as _e}from"./chunk-IDOUBITA.js";import{b as Ee}from"./chunk-NEF4TMLT.js";import{Sa as re,Ua as w,Wa as ae,Xa as le,Ya as ce,_ as ne,_a as k,ab as ue,cb as de,fb as me,jb as he,kb as pe,ma as oe,mb as Oe,nb as Ie,qa as se,rb as we,sb as ke,vb as ve,wb as Re}from"./chunk-G6XNEXZK.js";import{Cb as y,Da as K,F as V,Hb as g,Ia as T,M as j,Mb as f,Rb as a,Sb as c,Tb as _,Uc as W,X as b,_b as S,_c as X,da as O,ea as q,fb as d,g as R,h as A,i as F,ia as p,ja as h,kc as u,lc as N,mb as $,na as G,oa as B,ob as Z,od as I,s as z,sc as H,ub as J,uc as Y}from"./chunk-ELVZKH6B.js";import{a as E,g as x,h as L,i as U,j as v}from"./chunk-PXA7OGPQ.js";var Se=(()=>{let i=class i{constructor(){this.theme=J("light"),this._document=h(X),W(()=>{this.theme()==="dark"?this._document.documentElement.classList.add("dark"):this._document.documentElement.classList.remove("dark")})}toggleTheme(){this.theme.update(n=>n==="light"?"dark":"light")}};i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=O({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();var D=class{constructor(){}loadScript(i,m,n,e=null){if(typeof document<"u"&&!document.getElementById(i)){let t=document.createElement("script");t.async=!0,t.src=m,t.onload=n,e||(e=document.head),e.appendChild(t)}}},M=class{},Me={oneTapEnabled:!0},P=(()=>{let i=class i extends D{constructor(n,e){super(),this.clientId=n,this.initOptions=e,this.changeUser=new T,this._socialUser=new R(null),this._accessToken=new R(null),this._receivedAccessToken=new T,this.initOptions=E(E({},Me),this.initOptions),this._socialUser.pipe(b(1)).subscribe(this.changeUser),this._accessToken.pipe(b(1)).subscribe(this._receivedAccessToken)}initialize(n,e){return new Promise((t,o)=>{try{this.loadScript(i.PROVIDER_ID,this.getGoogleLoginScriptSrc(e),()=>{if(google.accounts.id.initialize({client_id:this.clientId,auto_select:n,callback:({credential:r})=>{let l=this.createSocialUser(r);this._socialUser.next(l)},prompt_parent_id:this.initOptions?.prompt_parent_id,itp_support:this.initOptions.oneTapEnabled,use_fedcm_for_prompt:this.initOptions.oneTapEnabled}),this.initOptions.oneTapEnabled&&this._socialUser.pipe(V(r=>r===null)).subscribe(()=>google.accounts.id.prompt(console.debug)),this.initOptions.scopes){let r=this.initOptions.scopes instanceof Array?this.initOptions.scopes.filter(l=>l).join(" "):this.initOptions.scopes;this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:this.clientId,scope:r,prompt:this.initOptions.prompt,callback:l=>{l.error?this._accessToken.error({code:l.error,description:l.error_description,uri:l.error_uri}):this._accessToken.next(l.access_token)}})}t()})}catch(r){o(r)}})}getLoginStatus(){return new Promise((n,e)=>{this._socialUser.value?n(this._socialUser.value):e(`No user is currently logged in with ${i.PROVIDER_ID}`)})}refreshToken(){return new Promise((n,e)=>{google.accounts.id.revoke(this._socialUser.value.id,t=>{t.error?e(t.error):n(this._socialUser.value)})})}getAccessToken(){return new Promise((n,e)=>{this._tokenClient?(this._tokenClient.requestAccessToken({hint:this._socialUser.value?.email}),this._receivedAccessToken.pipe(j(1)).subscribe(n)):this._socialUser.value?e("No token client was instantiated, you should specify some scopes."):e("You should be logged-in first.")})}revokeAccessToken(){return new Promise((n,e)=>{this._tokenClient?this._accessToken.value?google.accounts.oauth2.revoke(this._accessToken.value,()=>{this._accessToken.next(null),n()}):e("No access token to revoke"):e("No token client was instantiated, you should specify some scopes.")})}signIn(){return Promise.reject('You should not call this method directly for Google, use "<asl-google-signin-button>" wrapper or generate the button yourself with "google.accounts.id.renderButton()" (https://developers.google.com/identity/gsi/web/guides/display-button#javascript)')}signOut(){return v(this,null,function*(){google.accounts.id.disableAutoSelect(),this._socialUser.next(null)})}createSocialUser(n){let e=new M;e.idToken=n;let t=this.decodeJwt(n);return e.id=t.sub,e.name=t.name,e.email=t.email,e.photoUrl=t.picture,e.firstName=t.given_name,e.lastName=t.family_name,e}decodeJwt(n){let t=n.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(window.atob(t).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(o)}getGoogleLoginScriptSrc(n){return n?`https://accounts.google.com/gsi/client?hl=${n}`:"https://accounts.google.com/gsi/client"}};i.PROVIDER_ID="GOOGLE";let s=i;return s})(),Ne=(()=>{let i=class i{get authState(){return this._authState.asObservable()}get initState(){return this._initState.asObservable()}constructor(n,e,t){this._ngZone=e,this._injector=t,this.providers=new Map,this.autoLogin=!1,this.lang="",this._user=null,this._authState=new A(1),this.initialized=!1,this._initState=new F,n instanceof Promise?n.then(o=>{this.initialize(o)}):this.initialize(n)}initialize(n){this.autoLogin=n.autoLogin!==void 0?n.autoLogin:!1,this.lang=n.lang!==void 0?n.lang:"";let{onError:e=console.error}=n;n.providers.forEach(t=>{this.providers.set(t.id,"prototype"in t.provider?this._injector.get(t.provider):t.provider)}),Promise.all(Array.from(this.providers.values()).map(t=>t.initialize(this.autoLogin,this.lang))).then(()=>{if(this.autoLogin){let t=[],o=!1;this.providers.forEach((r,l)=>{let C=r.getLoginStatus();t.push(C),C.then(De=>{this.setUser(De,l),o=!0}).catch(console.debug)}),Promise.all(t).catch(()=>{o||(this._user=null,this._authState.next(null))})}this.providers.forEach((t,o)=>{z(t.changeUser)&&t.changeUser.subscribe(r=>{this._ngZone.run(()=>{this.setUser(r,o)})})})}).catch(t=>{e(t)}).finally(()=>{this.initialized=!0,this._initState.next(this.initialized),this._initState.complete()})}getAccessToken(n){return v(this,null,function*(){let e=this.providers.get(n);if(this.initialized)if(e){if(!(e instanceof P))throw i.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN}else throw i.ERR_LOGIN_PROVIDER_NOT_FOUND;else throw i.ERR_NOT_INITIALIZED;return yield e.getAccessToken()})}refreshAuthToken(n){return new Promise((e,t)=>{if(!this.initialized)t(i.ERR_NOT_INITIALIZED);else{let o=this.providers.get(n);o?typeof o.refreshToken!="function"?t(i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN):o.refreshToken().then(r=>{this.setUser(r,n),e()}).catch(r=>{t(r)}):t(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}})}refreshAccessToken(n){return new Promise((e,t)=>{if(!this.initialized)t(i.ERR_NOT_INITIALIZED);else if(n!==P.PROVIDER_ID)t(i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN);else{let o=this.providers.get(n);o instanceof P?o.revokeAccessToken().then(e).catch(t):t(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}})}signIn(n,e){return new Promise((t,o)=>{if(!this.initialized)o(i.ERR_NOT_INITIALIZED);else{let r=this.providers.get(n);r?r.signIn(e).then(l=>{this.setUser(l,n),t(l)}).catch(l=>{o(l)}):o(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}})}signOut(n=!1){return new Promise((e,t)=>{if(!this.initialized)t(i.ERR_NOT_INITIALIZED);else if(!this._user)t(i.ERR_NOT_LOGGED_IN);else{let o=this._user.provider,r=this.providers.get(o);r?r.signOut(n).then(()=>{e(),this.setUser(null)}).catch(l=>{t(l)}):t(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}})}setUser(n,e){n&&e&&(n.provider=e),this._user=n,this._authState.next(n)}};i.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",i.ERR_NOT_LOGGED_IN="Not logged in",i.ERR_NOT_INITIALIZED="Login providers not ready yet. Are there errors on your console?",i.ERR_NOT_SUPPORTED_FOR_REFRESH_TOKEN="Chosen login provider is not supported for refreshing a token",i.ERR_NOT_SUPPORTED_FOR_ACCESS_TOKEN="Chosen login provider is not supported for getting an access token",i.\u0275fac=function(e){return new(e||i)(p("SocialAuthServiceConfig"),p(Z),p(K))},i.\u0275prov=O({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})(),Pe=(()=>{let i=class i{static initialize(n){return{ngModule:i,providers:[Ne,{provide:"SocialAuthServiceConfig",useValue:n}]}}constructor(n){if(n)throw new Error("SocialLoginModule is already loaded. Import it in the AppModule only")}};i.\u0275fac=function(e){return new(e||i)(p(i,12))},i.\u0275mod=B({type:i}),i.\u0275inj=q({providers:[Ne],imports:[I]});let s=i;return s})();var Ce=()=>["/auth/forgot-password"];function xe(s,i){s&1&&(a(0,"mat-error"),u(1,"Please enter a valid userName address"),c())}function Le(s,i){s&1&&(a(0,"mat-error"),u(1,"UserName is "),a(2,"strong"),u(3,"required"),c()())}function Ue(s,i){s&1&&(a(0,"mat-error"),u(1,"Please enter a valid password address"),c())}function Ae(s,i){s&1&&(a(0,"mat-error"),u(1,"password is "),a(2,"strong"),u(3,"required"),c()())}var St=(()=>{var i;let m=class m{constructor(){L(this,i);this.router=h(Q),U(this,i,h(be)),this.permissionService=h(Te),this.renderer=h($),this.matcher=new ne,this.themeManager=h(Se),this.title="Angular",this.labelUserName="UserName",this.labelPassword="password",this.wobbleField=!1,this.theme=this.themeManager.theme}toggleTheme(){this.themeManager.toggleTheme()}createForm(){this.form=new ce({email:new k("",[w.required,w.email]),password:new k("",w.required),remmeber:new k(!1)})}refreshToken(){}ngOnInit(){this.createForm(),google.accounts.id.initialize({client_id:"940657570058-gpm7buu1t25nlls0pcbs95c6t2bf4rg4.apps.googleusercontent.com",callback:e=>{console.log("resposend",e),this.handleLogin(e)}}),google.accounts.id.renderButton(document.getElementById("google-btn"),{theme:"filled_blue",size:"large",shape:"rectangle"})}decodeToken(e){return JSON.parse(atob(e.split(".")[1]))}handleLogin(e){if(e&&e.credential){let t=this.decodeToken(e.credential);console.log("payload",t),sessionStorage.setItem("loggedInUser",JSON.stringify(t)),this.router.navigate(["aliakbar/dashboard"])}else console.error("Invalid response or missing credential")}login(e){this.form.value&&x(this,i).signIn(this.form.value).subscribe(t=>{this.permissionService.setPermissions(t.data.permissions);let o=t.data,r=JSON.stringify(o);localStorage.setItem("userData",r),this.router.navigate(["aliakbar/settings"])})}navigateRegister(){this.router.navigate(["auth/register"])}onAdminRol(e){this.role=e}onDoctorRol(e){}onPatientRol(e){}get email(){return this.form.get("email")}get password(){return this.form.get("password")}};i=new WeakMap,m.\u0275fac=function(t){return new(t||m)},m.\u0275cmp=G({type:m,selectors:[["app-login"]],standalone:!0,features:[H],decls:39,vars:11,consts:[[1,"desktop:flex","content","w-full","h-full"],[1,"w-1/2","desktop:block","mobile:hidden"],[1,"left-img"],[1,"desktop:w-1/2","text-center","h-screen","mt-28","w-full"],[1,"desktop:w-2/3","m-auto","desktop:mt-20","mobile:p-8"],[1,"desktop:text-left","font-extrabold","mobile:text-center"],[1,"cursor-pointer","flex","justify-start","text-xs","sign-up"],[1,"ml-2",3,"click"],[1,"text-blue-600"],[1,"w-full"],[1,"text-left","font-extrabold","text-3xl","p-3"],[3,"ngSubmit","formGroup"],["data-testing","username","appearance","outline",1,"w-full"],["type","text","matInput","","formControlName","email","placeholder","UserName",3,"errorStateMatcher"],["appearance","outline",1,"w-full","pt-2"],["type","Password","matInput","","formControlName","password","placeholder","Password",3,"errorStateMatcher"],[1,"flex","justify-between","items-center"],["formControlName","remmeber"],["routerLinkActive","router-link-active",1,"cursor-pointer","flex","justify-end","text-xs","dark:textblu","hover:text-blue","mt-7","mb-7",3,"routerLink"],["mat-flat-button","","data-testid","login-button","color","primary","type","submit",1,"login-button","ease-in-out","duration-300","w-full","desktop:m-0","tablet:mt-2","mobile:mt-2"],[1,"social-login-title"],[1,"flex","justify-center","items-center","gap-3"],["id","google-btn"]],template:function(t,o){t&1&&(a(0,"div",0)(1,"section",1),_(2,"div",2),c(),a(3,"section",3)(4,"div",4)(5,"h3",5),u(6,"Welcome Back"),c(),a(7,"h2",6),u(8," Need an account? "),a(9,"a",7),S("click",function(){return o.navigateRegister()}),a(10,"strong",8),u(11,"Sign up"),c()()(),a(12,"div",9)(13,"h3",10),u(14,"Sign in"),c(),a(15,"form",11),S("ngSubmit",function(l){return o.login(l)}),a(16,"mat-form-field",12)(17,"mat-label"),u(18),c(),_(19,"input",13),y(20,xe,2,0,"mat-error")(21,Le,4,0,"mat-error"),c(),a(22,"mat-form-field",14)(23,"mat-label"),u(24),c(),_(25,"input",15),y(26,Ue,2,0,"mat-error")(27,Ae,4,0,"mat-error"),c(),a(28,"div",16)(29,"mat-checkbox",17),u(30,"Remember me"),c(),a(31,"a",18),u(32," Forgot Password? "),c()(),a(33,"button",19),u(34," Login "),c(),a(35,"h2",20),u(36,"OR"),c(),a(37,"div",21),_(38,"div",22),c()()()()()()),t&2&&(d(15),g("formGroup",o.form),d(3),N(o.labelUserName),d(),g("errorStateMatcher",o.matcher),d(),f(o.email!=null&&o.email.hasError("email")&&!(o.email!=null&&o.email.hasError("required"))?20:-1),d(),f(o.email!=null&&o.email.hasError("required")?21:-1),d(3),N(o.labelPassword),d(),g("errorStateMatcher",o.matcher),d(),f(o.password!=null&&o.password.hasError("password")&&!(o.password!=null&&o.password.hasError("required"))?26:-1),d(),f(o.password!=null&&o.password.hasError("required")?27:-1),d(4),g("routerLink",Y(10,Ce)))},dependencies:[he,ue,re,ae,le,pe,de,me,ge,Re,ve,we,Oe,Ie,se,oe,ke,ee,I,Ee,ie,te,_e,fe,Pe],styles:['.content[_ngcontent-%COMP%]{background-color:#fff}.left-img[_ngcontent-%COMP%]{background-image:url("./media/bg-01-724LABUB.png");height:100%;width:100%;background-repeat:no-repeat;background-position:center center;background-size:cover;display:flex;align-items:center;justify-content:center;padding:30px 15px;position:relative;z-index:1}.social-login-title[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;text-align:center;position:relative;font-size:1.5em;margin:0}.social-login-title[_ngcontent-%COMP%]:before, .social-login-title[_ngcontent-%COMP%]:after{content:"";flex-grow:1;height:1px;background:linear-gradient(to right,#bbb8b8,#f3f3f3);margin:0 10px}.social-login-title[_ngcontent-%COMP%]:after{background:linear-gradient(to left,#bbb8b8,#f3f3f3)}.sign-up[_ngcontent-%COMP%]{color:#97a2b4}.login-button[_ngcontent-%COMP%]{transition:all .3s ease-in-out}.login-button[_ngcontent-%COMP%]:hover{transform:scale(1.05)}']});let s=m;return s})();export{Se as a,St as b};
